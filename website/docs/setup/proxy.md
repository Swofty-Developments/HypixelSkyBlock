# Proxy Setup

The Velocity proxy acts as the entry point for all player connections and routes them to the appropriate game servers.

## Download Required Files

1. Download `SkyBlockProxy.jar` from the [releases page](https://github.com/Swofty-Developments/HypixelSkyBlock/releases/tag/latest)
2. Download [Velocity 3.4.0](https://fill-data.papermc.io/v1/objects/ef1a852bfae7397e84907837925e7ad21c6312066290edaae401b77f6f423ac3/velocity-3.4.0-SNAPSHOT-558.jar)
3. Download [`velocity.toml`](https://github.com/Swofty-Developments/HypixelSkyBlock/tree/master/configuration)
4. Download [`config.yml`](https://github.com/Swofty-Developments/HypixelSkyBlock/tree/master/configuration)

## Directory Structure

Create the following structure:

```
proxy/
├── velocity-3.4.0-SNAPSHOT-558.jar
├── velocity.toml
├── configuration/
│   └── config.yml
└── plugins/
    └── SkyBlockProxy.jar
```

## Setup Steps

1. **Create proxy directory** and move `velocity.toml` and the Velocity JAR into it

2. **First run** - Start the proxy to generate required files:
   ```bash
   java -jar velocity-3.4.0-SNAPSHOT-558.jar
   ```

3. **Stop the proxy** once the `plugins` folder is generated (Ctrl+C)

4. **Install plugin** - Move `SkyBlockProxy.jar` into the `plugins` folder

5. **Create configuration folder** - Make a `configuration` folder next to `velocity.toml`

6. **Add config.yml** - Move `config.yml` into the `configuration` folder

7. **Start the proxy**:
   ```bash
   java -jar velocity-3.4.0-SNAPSHOT-558.jar
   ```

## Configuration

### velocity.toml

Key settings to verify:

```toml
bind = "0.0.0.0:25565"
online-mode = true  # Set to false for cracked servers
player-info-forwarding-mode = "modern"
```

### config.yml

This file contains shared configuration used by both the proxy and game servers. Key fields:

```yml
host-name: 0.0.0.0
transfer-timeout: 800
mongodb: mongodb://localhost
redis-url: redis://localhost:6379
velocity-secret: your-forwarding-secret-here
require-auth: false
sandbox: false
spark: false
anticheat: false
redis-uri: redis://localhost:6379
limbo:
   host-name: 127.0.0.1
   port: 65535
```

:::alert warning
The `velocity-secret` must match the contents of `forwarding.secret` generated by Velocity.
:::

## Cracked Server Setup

To run a cracked (offline-mode) server:

1. Set `online-mode = false` in `velocity.toml`
2. Set `require-authentication` to `true` in your game server config

## Verification

When the proxy starts successfully, you should see:
- Plugin loaded message for SkyBlockProxy
- Listening on port 25565
- No connection errors to Redis

The proxy must remain running for game servers to connect.
